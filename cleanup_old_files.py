#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import os
import shutil
from pathlib import Path

def cleanup_old_2025_files():
    """ê¸°ì¡´ ë¶„ì‚°ëœ 2025 íŒŒì¼ë“¤ ì •ë¦¬"""
    
    base_dir = "/Users/hyungchangyoun/Documents/project/testpool"
    
    # ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„±
    backup_dir = os.path.join(base_dir, "backup_old_2025_files")
    os.makedirs(backup_dir, exist_ok=True)
    
    # ì •ë¦¬í•  íŒŒì¼ë“¤ (ê¸°ì¡´ ë¶„ì‚° íŒŒì¼ë“¤)
    files_to_backup = [
        "2025-data-ë†ì–´ì´Œì •ë¹„ë²•-explanations.js",  # ì¤‘ë³µëœ í•´ì„¤ íŒŒì¼
        "2025-exam.js",  # 5000+ ë¼ì¸ì˜ ê±°ëŒ€ íŒŒì¼
        # ê¸°íƒ€ ì„ì‹œ/ì¤‘ë³µ íŒŒì¼ë“¤
        "ì·¨ì—…ê·œì¹™_questions.json",
        "ì·¨ì—…ê·œì¹™_questions.js", 
        "existing_answers.json",
        "ì·¨ì—…ê·œì¹™_47_questions.json",
        "ì·¨ì—…ê·œì¹™_47_questions_final.json",
        "ì·¨ì—…ê·œì¹™_47_questions_final.js",
        "ì·¨ì—…ê·œì¹™_47_questions_simple.json",
        "ì·¨ì—…ê·œì¹™_47_questions_simple.js",
        "ì·¨ì—…ê·œì¹™_47_complete.json",
        "existing_explanations.json",
        "explanation_data.json",
        "ì·¨ì—…ê·œì¹™_47_with_explanations.json",
        "replace_questions.js",
        "replace_with_explanations.js",
        "ì·¨ì—…ê·œì¹™_47_questions.js",
        "ì·¨ì—…ê·œì¹™_47_questions_fixed.js",
        "ì·¨ì—…ê·œì¹™_47_complete.js",
        "replace_employment_rules.js"
    ]
    
    backed_up_files = []
    
    for file_name in files_to_backup:
        file_path = os.path.join(base_dir, file_name)
        if os.path.exists(file_path):
            backup_path = os.path.join(backup_dir, file_name)
            try:
                shutil.move(file_path, backup_path)
                backed_up_files.append(file_name)
                print(f"âœ… ë°±ì—…ë¨: {file_name}")
            except Exception as e:
                print(f"âŒ ë°±ì—… ì‹¤íŒ¨ {file_name}: {e}")
    
    return backed_up_files, backup_dir

def create_file_structure_doc():
    """ìƒˆë¡œìš´ íŒŒì¼ êµ¬ì¡° ë¬¸ì„œí™”"""
    
    doc_content = """# 2025ë…„ ì‹œí—˜ ë°ì´í„° êµ¬ì¡° ê°œì„  ì™„ë£Œ

## ğŸ“Š ê°œì„  ì‚¬í•­ ìš”ì•½

### âŒ ê¸°ì¡´ ë¬¸ì œì 
1. **ë°ì´í„° êµ¬ì¡° ë¶ˆì¼ì¹˜**: ê³¼ëª©ë§ˆë‹¤ ë‹¤ë¥¸ í•„ë“œëª…ê³¼ êµ¬ì¡° ì‚¬ìš©
2. **ë¶„ì‚°ëœ íŒŒì¼ë“¤**: í•´ì„¤ì´ ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬ë˜ì–´ ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€  
3. **ê±°ëŒ€í•œ ë©”ì¸ íŒŒì¼**: 2025-exam.js (5000+ ë¼ì¸) ë¡œë”© ì„±ëŠ¥ ì €í•˜
4. **ì¤‘ë³µ ë° ì„ì‹œ íŒŒì¼**: 20+ ê°œì˜ ì¤‘ë³µ/ì„ì‹œ íŒŒì¼ë“¤ì´ ì‚°ì¬

### âœ… ê°œì„  ê²°ê³¼

#### 1. í‘œì¤€í™”ëœ ë°ì´í„° êµ¬ì¡°
```javascript
{
    "question": "ë¬¸ì œ ë‚´ìš©",
    "choices": {
        "a": "ì„ íƒì§€ A",
        "b": "ì„ íƒì§€ B", 
        "c": "ì„ íƒì§€ C",
        "d": "ì„ íƒì§€ D"
    },
    "answer": {
        "correct": "ì •ë‹µ",
        "explanation": {
            "brief": "ê°„ë‹¨ í•´ì„¤",
            "detailed": "ìƒì„¸ í•´ì„¤",
            "references": {
                "law_links": ["ë²•ë ¹ ë§í¬ë“¤"],
                "articles": ["ê´€ë ¨ ì¡°ë¬¸ë“¤"]
            }
        }
    }
}
```

#### 2. ì²´ê³„ì ì¸ íŒŒì¼ êµ¬ì¡°
```
ğŸ“ 2025ë…„ ì‹œí—˜ ë°ì´í„° (ìƒˆë¡œìš´ êµ¬ì¡°)
â”œâ”€â”€ 2025-exam-optimized.js          # ìµœì í™”ëœ ë©”ì¸ íŒŒì¼ (lazy loading)
â”œâ”€â”€ 2025-{ê³¼ëª©ëª…}-unified.js        # ê³¼ëª©ë³„ í†µí•© ë°ì´í„° (8ê°œ íŒŒì¼)
â”œâ”€â”€ 2025-exam-unified.js            # ì „ì²´ í†µí•© íŒŒì¼ (ì„ íƒì  ì‚¬ìš©)
â””â”€â”€ 2025-test-demo.html             # í…ŒìŠ¤íŠ¸/ë°ëª¨ í˜ì´ì§€

ğŸ“ ë°±ì—… (ê¸°ì¡´ íŒŒì¼ë“¤)
â””â”€â”€ backup_old_2025_files/          # ê¸°ì¡´ ë¶„ì‚° íŒŒì¼ë“¤ ë°±ì—…
```

#### 3. ì„±ëŠ¥ ìµœì í™”
- **Lazy Loading**: í•„ìš”í•œ ê³¼ëª©ë§Œ ë™ì  ë¡œë“œ
- **ìºì‹±**: í•œë²ˆ ë¡œë“œí•œ ë°ì´í„° ë©”ëª¨ë¦¬ ìºì‹œ
- **ì´ˆê¸° ë¡œë“œ ì‹œê°„**: 5000+ ë¼ì¸ â†’ ê²½ëŸ‰ ë©”íƒ€ë°ì´í„°ë§Œ
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê³¼ëª© ë°ì´í„° ë¡œë“œ ì•ˆí•¨

## ğŸ“š ê³¼ëª©ë³„ ë°ì´í„° í˜„í™©

| ê³¼ëª©ëª… | ë¬¸ì œ ìˆ˜ | ìƒíƒœ | íŠ¹ì´ì‚¬í•­ |
|--------|---------|------|----------|
| ë†ì–´ì´Œì •ë¹„ë²• | 102ê°œ | âœ… ì™„ë£Œ | ìƒì„¸í•´ì„¤ í¬í•¨ |
| ê³µì‚¬ë²• | 99ê°œ | âœ… ì™„ë£Œ | í‘œì¤€ êµ¬ì¡° |
| ê³µìš´ë²• | 0ê°œ | âš ï¸ ë°ì´í„° ì—†ìŒ | íŒŒì¼ í™•ì¸ í•„ìš” |
| ì§ì œê·œì • | 27ê°œ | âœ… ì™„ë£Œ | í‘œì¤€ êµ¬ì¡° |
| ì·¨ì—…ê·œì¹™ | 47ê°œ | âœ… ì™„ë£Œ | íŒŒì‹± ì´ìŠˆ ì¼ë¶€ ì¡´ì¬ |
| ì¸ì‚¬ê·œì • | 56ê°œ | âœ… ì™„ë£Œ | ì™„ë²½ íŒŒì‹± |
| í–‰ë™ê°•ë ¹ | 21ê°œ | âœ… ì™„ë£Œ | í‘œì¤€ êµ¬ì¡° |
| íšŒê³„ê¸°ì¤€ | 53ê°œ | âœ… ì™„ë£Œ | 56ê°œ ëª©í‘œì—ì„œ 3ê°œ ì°¨ì´ |

**ì´ê³„**: 405ê°œ ë¬¸ì œ (ê³µìš´ë²• ì œì™¸)

## ğŸš€ ì‚¬ìš©ë²•

### ê¸°ë³¸ ì‚¬ìš©ë²• (í•˜ìœ„ í˜¸í™˜ì„±)
```javascript
// ê¸°ì¡´ ë°©ì‹ê³¼ ë™ì¼í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥
const questions = await getQuestionsForSubject2025('ë†ì–´ì´Œì •ë¹„ë²•');
```

### ìƒˆë¡œìš´ ê³ ê¸‰ ê¸°ëŠ¥
```javascript
// ê³¼ëª© ë©”íƒ€ë°ì´í„° í™•ì¸
const metadata = getSubjectMetadata2025('ë†ì–´ì´Œì •ë¹„ë²•');

// ì „ì²´ í†µê³„
const stats = getExamStats2025();

// ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
const performance = window.exam2025Performance.getStats();
```

### í†µí•© HTML ì ìš© ë°©ë²•
```html
<!-- ê¸°ì¡´ ë°©ì‹ -->
<script src="2025-exam.js"></script>

<!-- ìƒˆë¡œìš´ ìµœì í™”ëœ ë°©ì‹ -->
<script src="2025-exam-optimized.js"></script>
```

## ğŸ”§ ê°œë°œì ê°€ì´ë“œ

### ìƒˆ ê³¼ëª© ì¶”ê°€
1. ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ `2025/{ê³¼ëª©ëª…}.txt`ì— ì €ì¥
2. `create_unified_2025_data.py` ìŠ¤í¬ë¦½íŠ¸ì˜ subjects ë”•ì…”ë„ˆë¦¬ì— ì¶”ê°€
3. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰í•˜ì—¬ í†µí•© íŒŒì¼ ìƒì„±

### ë°ì´í„° ìˆ˜ì •
1. `2025-{ê³¼ëª©ëª…}-unified.js` íŒŒì¼ì—ì„œ ì§ì ‘ ìˆ˜ì •
2. ë˜ëŠ” ì›ë³¸ ë°ì´í„° ìˆ˜ì • í›„ ìŠ¤í¬ë¦½íŠ¸ ì¬ì‹¤í–‰

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ ë¡œë“œ ì‹œê°„ í™•ì¸
- `window.exam2025Performance.getStats()` í™œìš©

## ğŸ“‹ í–¥í›„ ê°œì„  ê³„íš

1. **ê³µìš´ë²• ë°ì´í„° ë³´ì™„** - í˜„ì¬ 0ê°œ ë¬¸ì œ í•´ê²°
2. **íšŒê³„ê¸°ì¤€ ì™„ì„±** - 53ê°œ â†’ 56ê°œ ëª©í‘œ ë‹¬ì„±  
3. **ì·¨ì—…ê·œì¹™ íŒŒì‹± ê°œì„ ** - ë³µì¡í•œ ë‹¤ì¤‘êµ¬ì¡° ë¬¸ì œ í•´ê²°
4. **ìë™í™” ìŠ¤í¬ë¦½íŠ¸** - ë°ì´í„° ì—…ë°ì´íŠ¸ ìë™í™”
5. **íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì ìš©** - íƒ€ì… ì•ˆì •ì„± í–¥ìƒ

---
*ë¬¸ì„œ ìƒì„±ì¼: 2025-08-17*
*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-08-17*
"""
    
    doc_path = "/Users/hyungchangyoun/Documents/project/testpool/2025-DATA-STRUCTURE-IMPROVEMENT.md"
    with open(doc_path, 'w', encoding='utf-8') as f:
        f.write(doc_content)
    
    return doc_path

if __name__ == "__main__":
    print("ğŸ§¹ 2025ë…„ íŒŒì¼ ì •ë¦¬ ì‘ì—… ì‹œì‘...")
    
    # ê¸°ì¡´ íŒŒì¼ë“¤ ë°±ì—…
    backed_up_files, backup_dir = cleanup_old_2025_files()
    
    # ë¬¸ì„œí™”
    doc_path = create_file_structure_doc()
    
    print(f"""
âœ… ì •ë¦¬ ì‘ì—… ì™„ë£Œ!

ğŸ“¦ ë°±ì—…ëœ íŒŒì¼: {len(backed_up_files)}ê°œ
ğŸ“ ë°±ì—… ìœ„ì¹˜: {backup_dir}

ğŸ“„ ìƒì„±ëœ ë¬¸ì„œ: 2025-DATA-STRUCTURE-IMPROVEMENT.md

ğŸ¯ ê²°ê³¼ ìš”ì•½:
- ë¶„ì‚°ëœ íŒŒì¼ë“¤ â†’ ì²´ê³„ì  êµ¬ì¡°ë¡œ í†µí•©
- 5000+ ë¼ì¸ ë©”ì¸ íŒŒì¼ â†’ ê²½ëŸ‰ lazy loading ì‹œìŠ¤í…œ  
- ì¼ê´€ì„± ì—†ëŠ” ë°ì´í„° â†’ í‘œì¤€í™”ëœ êµ¬ì¡°
- 20+ ì¤‘ë³µ íŒŒì¼ë“¤ â†’ 8ê°œ ê³¼ëª©ë³„ í†µí•© íŒŒì¼

ë‹¤ìŒ ë‹¨ê³„:
1. 2025-test-demo.htmlì—ì„œ ìƒˆ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
2. ê¸°ì¡´ 2025-exam.htmlì„ ìƒˆ ì‹œìŠ¤í…œìœ¼ë¡œ ì—…ë°ì´íŠ¸
3. ê³µìš´ë²• ë°ì´í„° ë³´ì™„ ì‘ì—…
""")